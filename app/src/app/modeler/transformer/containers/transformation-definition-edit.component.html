<m-page mFull class="transformation-definition" *ngIf="definition">
  <div class="header m-items-middle m-justify-between">
    <div>
      {{definition.name}}

      <div *ngIf="definition.id && (definition.modifiedBy || definition.createdBy)" class="m-text-secondary m-text-small">
        <m-icon mCode="clock-circle"/>
        {{(definition.modifiedAt ? 'web.transformation-definition.edit.updated' : 'web.transformation-definition.edit.created') | translate: ({date: (definition.modifiedBy ? definition.modifiedAt : definition.createdAt) | localDateTime})}}

        <m-icon mCode="user"/>
        {{definition.modifiedBy ?? definition.createdBy}}
      </div>
    </div>

    <div class="m-items-middle">
      <m-icon-button mIcon="rocket"/>
      <m-divider mVertical></m-divider>
      <m-button mDisplay="primary">Save</m-button>
      <m-button>Cancel</m-button>

    </div>
  </div>

  <div class="container">
    <div
        class="tabs-wrapper"
        [class.tabs-wrapper--open]="selectedResourceType"
    >
<!--      <div class="tabs-container">
        <ng-container *ngFor="let type of types">
          <div class="tab-item" [class.active]="selectedResourceType === type" (click)="onTypeSelect(type)">
            <div>
              &lt;!&ndash;              <nz-badge [nzCount]="(definition.resources | filter: filterByType: type).length" nzSize="small">&ndash;&gt;
              <m-icon mCode="file"/>
              &lt;!&ndash;              </nz-badge>&ndash;&gt;
            </div>
          </div>
        </ng-container>

        <span class="filler"></span>
      </div>-->

      <div class="tabs-content">
        <ng-container *ngFor="let type of types">
          <tw-transformation-definition-resource
              [type]="type"
              [definition]="definition"
              [(selectedResource)]="selectedResource"
          ></tw-transformation-definition-resource>
        </ng-container>
      </div>
    </div>


    <div class="main">
      <m-alert
          *ngIf="selectedResource?.['_imported']"
          class="tw-alert--no-line m-rounded"
          mTitle="web.transformation-definition.import.import-map.title"
          mDescription="web.transformation-definition.import.import-map.description"
          mType="warning"
          mShowIcon
      ></m-alert>

      <m-button
          *ngIf="selectedResource !== definition.mapping"
          mSize="small"
          (mClick)="selectedResource = definition.mapping"
      >
        Back to mapping
      </m-button>

      <tw-transformation-definition-resource-form
          [definition]="definition"
          [resource]="selectedResource"
          [disabled]="selectedResource?.['_imported']"
      ></tw-transformation-definition-resource-form>
    </div>

    <m-collapse-panel
        class="input"
        mKey="fml-execution"
        mCollapsePosition="right"
        mResizable
        [mResizableMinWidth]="300"
    >
      <tw-transformation-definition-execution [definition]="definition"/>
    </m-collapse-panel>
  </div>


  <!--  top bar-->

  <!-- categories-->
  <!--  left sidebar-->

  <!-- main content -->
  <!-- input/output-->

</m-page>
