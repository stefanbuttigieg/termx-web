<div nz-row nzJustify="center">
  <div nz-col [nzLg]="18" [nzXs]="24">
    <m-spinner [mLoading]="loading['save']">
      <m-card [mTitle]="('web.map-set.form.header' | translate) +  (mapSetId ? ' ' + mapSetId : '')" [mShowSkeleton]="loading['init']" autofocus>
        <form #form="ngForm" *ngIf="mapSet">
          <m-form-item mLabel="entities.map-set.name">
            <m-multi-language-input name="name" [(ngModel)]="mapSet.names" (ngModelChange)="nameChanged($event)"></m-multi-language-input>
          </m-form-item>

          <m-form-item mName="id" mLabel="entities.map-set.id" required>
            <m-input name="id" [(ngModel)]="mapSet.id" [disabled]="mode === 'edit'" required></m-input>
          </m-form-item>

          <m-form-item mName="source" mLabel="entities.map-set-version.source">
            <tw-value-set-concept-select name="source"
                [(ngModel)]="mapSet.versions[0].source"
                (ngModelChange)="publisherChanged($event)"
                valueSet="publisher"
                required></tw-value-set-concept-select>
          </m-form-item>

          <m-form-item mName="uri" mLabel="entities.map-set.uri" required>
            <div class="m-items-middle">
              <m-input style="width: 100%" name="uri" [(ngModel)]="mapSet.uri" required></m-input>
              <a *ngIf="mapSet.uri | validateUrl" [href]="mapSet.uri" target="_blank">
                <m-button>
                  <m-icon mCode="eye"></m-icon>
                </m-button>
              </a>
            </div>
          </m-form-item>

          <m-form-item mName="description" mLabel="entities.code-system.description">
            <m-textarea name="description" [(ngModel)]="mapSet.description"></m-textarea>
          </m-form-item>

          <m-form-item mName="sourceValueSet" mLabel="entities.map-set.source-value-set">
            <tw-value-set-search name="sourceValueSet" [(ngModel)]="mapSet.sourceValueSet" valuePrimitive></tw-value-set-search>
          </m-form-item>

          <m-form-item mName="targetValueSet" mLabel="entities.map-set.target-value-set">
            <tw-value-set-search name="targetValueSet" [(ngModel)]="mapSet.targetValueSet" valuePrimitive></tw-value-set-search>
          </m-form-item>

        </form>

        <ng-container *m-card-footer>
          <m-button mDisplay="primary" [mLoading]="loading['save']" [disabled]="loading['save'] || loading['init']" (click)="save()">
            {{'core.btn.save' | translate}}
          </m-button>
        </ng-container>
      </m-card>
    </m-spinner>
  </div>
</div>
