<m-no-data *ngIf="!propertyValues?.length"/>

<ng-container *ngFor="let pv of propertyValues | sort: 'entityPropertyId'; let i = index">
  <ng-container *ngIf="viewMode">
    <div class="m-items-middle">
      <span class="m-subtitle">{{pv.entityProperty}}</span>
      <tw-property-value-input [ngModel]="pv.value" [property]="pv.entityPropertyId | apply: getProperty: properties" [codeSystem]="codeSystemId" viewMode/>
    </div>
  </ng-container>

  <ng-container *ngIf="!viewMode">
    <form #form="ngForm">
      <div class="m-items-middle">
        <m-form-item mName="{{i}}-property" required>
          <m-select *ngIf="!(i | apply:isRequired:properties)"
              name="{{i}}-property"
              [(ngModel)]="pv.entityPropertyId"
              placeholder="entities.entity-property.type"
              icon="search"
              required>
            <m-option *ngFor="let prop of properties" [mValue]="prop.id" [mLabel]="prop.name"></m-option>
          </m-select>
          <label *ngIf="i | apply:isRequired:properties">{{pv.entityProperty}}</label>
        </m-form-item>
        <m-form-item style="width: 100%" *ngIf="pv.entityPropertyId" mName="{{i}}-propertyValue">
          <tw-property-value-input [(ngModel)]="pv.value"
              name="{{i}}-propertyValue"
              [property]="pv.entityPropertyId | apply:getProperty:properties"
              [codeSystem]="codeSystemId"
              [required]="(i | apply:isRequired:properties)"></tw-property-value-input>
        </m-form-item>
      </div>
    </form>
  </ng-container>
</ng-container>

